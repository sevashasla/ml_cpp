#include <iostream>
#include <vector>
#include <list>
#include <memory>
#include "ml.h"

using std::cin, std::cout, std::vector;


int main(){
	std::shared_ptr<nn::BatchNorm> bn = std::make_shared<nn::BatchNorm>();

	std::vector<std::vector<double>> xv({
		{-8.15979402939878, -7.983845671565377}, {-7.512010748443737, -6.9287203998185465}, 
		{-9.811151112664817, -3.543296900154948}, {-9.837675434205272, -3.0771796262469797}, 
		{-10.668374789942131, -3.5757847610422853}, {-1.6173461592329268, 4.9893050825589835}, 
		{-10.303916516281474, -3.1253739047559583}, {-0.794152276623841, 2.104951171962879}, 
		{-9.484782683235093, -4.25144138246592}, {-10.20660673702788, -3.366725356181007}, 
		{-6.324325732561464, -9.10692870643198}, {-6.714336204993631, -9.465511515861477}, 
		{0.08525185826796045, 3.6452829679480585}, {-9.682077556411496, -5.975549763187208}, 
		{-0.7587039566841077, 3.7227620096688283}, {-9.509194357115604, -4.02892026038426}, 
		{-8.264150215992924, -7.289882787080023}, {-7.81213709711994, -5.349844882851342}, 
		{-7.4401671337478525, -8.791958512078267}, {-9.158729089778596, -3.0222464660596473}, 
		{-7.408735859228814, -8.109631247789798}, {-1.9819771099620271, 4.022435514174746}, 
		{-1.7824501314671677, 3.4707204345840927}, {-8.866083116201674, -2.433531730941006}, 
		{0.00024227116135100424, 5.148534029420497}, {-6.943060912666302, -7.0237441967121255}, 
		{-10.752110444649754, -2.7004803921299168}, {-2.406718199699357, 6.098944469870908}, 
		{-8.437999503904495, -7.838068712581753}, {-6.218721536072705, -9.012744045456031}, 
		{-11.44182630908269, -4.4578144103096555}, {-7.10357769292379, -9.769000459327339}, 
		{-10.220040646263461, -4.154106616293202}, {-1.8319881134989553, 3.5286314509217895}, 
		{-2.346732606068119, 3.561284227344442}, {-6.641387829593626, -8.075888036275485}, 
		{-9.697542183697275, -4.305598393856723}, {-1.340520809891421, 4.157119493365752}, 
		{-1.6087521511724905, 3.769494222273808}, {-2.351220657673829, 4.0097363419871845}, 
		{-9.877553551171472, -3.3361454376557855}, {-0.19745196890354544, 2.3463491593455075}, 
		{-5.943464475422075, -7.744327566687217}, {-5.437231430508833, -7.815216408049569}, 
		{-2.760179083161441, 5.551213578682775}, {-1.8513954583101344, 3.5188609047583252}, 
		{-2.3308060367853387, 4.39382526992426}, {-8.92286404810449, -6.917064074171225}, 
		{-2.187731658211975, 3.333521246686991}, {-7.089499139533517, -8.928389723793204}, 
		{-5.865964303756232, -7.968071687140101}, {-6.661390541866939, -7.559649581386978}, 
		{-7.331100689661361, -8.120613557930687}, {-7.684883027605868, -7.455196070551826}, 
		{-5.7911262534989625, -6.186126355369311}, {-11.140230701675241, -4.302691269776082}, 
		{-0.5257904636130821, 3.3065986015291307}, {-1.9274479855745354, 4.9368453355813475}, 
		{-0.757969185355724, 4.908984207745029}, {-9.799412783526332, -3.834339901555746}, 
		{-9.767617768288718, -3.19133736705118}, {-9.806797018985636, -1.8530934108843624}, 
		{-9.712125178398843, -3.0682073830924765}, {-2.7768702545837973, 4.640905566660254}
	});

	Matrix<double> x(xv);
	Matrix<double> out1 = bn->forward(x);


	return 0;
}

